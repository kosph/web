<!DOCTYPE html>
<html>
    <head>
	<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"/>
        <meta charset="UTF-8">
		<style>
		 #name::-webkit-input-placeholder{
            color:white;
        }
        #name::-moz-placeholder{   /* Mozilla Firefox 19+ */
            color:white;
        }
        #name:-moz-placeholder{    /* Mozilla Firefox 4 to 18 */
            color:white;
        }
        #name:-ms-input-placeholder{  /* Internet Explorer 10-11 */ 
            color:white;
        }
		#name{
		color:white;
		border-top:0;
		border-right:0;
		border-left:0;
		border-bottom:2px solid white;
			background:none;
			outline:none;	}
		#btyellow{
		color:black;
		background-color:RGB(254,236,152);
		margin:2%;
		margin-bottom:5%;
		width:96%;
		}
		*{
		font-family: Arial, "Microsoft YaHei", "微软雅黑";}
		body{

		}
		
		#mask3{
			-webkit-background-size:100% ;
			position:absolute;
			left:0;
			top:0;
			z-index:600;
			height:100%;
			width:100%;
			background-image:url(bg-v22.jpg);
			background-position:center;
			background-repeat:no-repeat;
			background-size:100%;
			display:block;
		}
		#mask2{
			-webkit-background-size:100% ;
			position:absolute;
			left:0;
			top:0;
			z-index:-1;
			height:100%;
			width:100%;
			background-image:url(bg-v2.jpg);
			background-position:center;
			background-repeat:no-repeat;
			background-size:100%;
			display:block;
		}
		#mask{
			-webkit-background-size:100% 100%;
			position:absolute;
			left:0;
			top:0;
			z-index:100;
			height:100%;
			width:100%;
			background-repeat:no-repeat;
			background-image:url(bg-v2.jpg);
			background-size:100%;
			background-position:center;
			display:block;
			visibility:hidden;
		}
		#load{
		width:20%;

		margin-left:40%;
		margin-top:79%;
		}
		span{
			color:black;
		}
		#hide{
		width:100%;
		
		height:100%;
		display:none;
			text-align:center;
		}
		input{
			margin-top:55%;
			width:80%;
			height:2.5em;
			text-align:center;
			font-size:20px;
		}
		button{
			font-family: 'Oswald', Arial, sans-serif;
			background-color: #FF4081;
			color: white;
			
			border: none;
			margin-top:20%;
			width:60%;
			height:2.7em;
			text-align:center;
			
			font-size:15px;
			border-radius:8px;
		}
		*{
			margin: 0;
		}
		#t1{
			border-radius:6px;
			margin:2%;
			width:96%;
			display:none;
			background-color:white;
			box-shadow: 6px 6px 3px #bebebe;
			
		}
		#test{
		padding-top:25%;
			text-align: center;
			background-image:url(1.png);
			-webkit-background-size:100%;
			background-size:100%;
			background-position:center;
			background-repeat:no-repeat;
			display:none;
			height:500px;
		}
		#t1,#test{ 
			/*display:none;*/
			
		}
		img{margin:2%;
		width:96%;
		}
		#bg-img{
		visibility:hidden;
		}
		#h3{
		color:black;
			font-size:10px;
			margin:2%;
		}
		h1{
			font-size:20px;
			margin:2%;
			margin-top:0%;
		}
		p{
			
			height:60%;
			padding:5% 10%;
			margin-left:15%;
			margin-right:15%;
			color:white;
			font-size:1em;
			text-align:left;
			line-height:2em;
			letter-spacing:2px;

		}
		canvas{
			margin-right: 5px;
		}
		#btRan{
		background-color: RGB(186,187,191);
		border:1px solid white;
		outline:none;
		}
		.logo{
		z-index:3;
		width:15%;
		position:absolute;
		right:8%;
		top:9%;
		}
        </style>
	</head>
    
    <body><!--
	<div id="test"><img src = "1.png" id ="bg-img"/><p id = "z-2">&emsp;&emsp;<span>2333</span>在1906年考入复旦公学，1909年成为复旦公学第二届毕业生，其卒业文凭现在是复旦大学校史馆的“镇馆之宝”。</p></div>
    -->
	<div id="test"></div>
	<div id = "t1"><section id = "h3">你的专属签文</section>
	<h1>长按保存你的结果图片吧</h1></div>
	<div id = "hide">
		<input type = "text" id = "name" placeholder = "请输入你的名字"/><br/>
		<button id = "btRan"onclick = "btClick();">抽取你的专属签文</button>
	</div>
	<div id = "mask"><img id = "load" src = "load.gif"/></div>
	<div id = "mask2"></div>
	<div id = "mask3"></div>

    <script src="html2canvas.js"></script>
	<script src="jquery-3.3.1.js"></script>
	<script>
	function btClick(){
	username = document.getElementById('name').value;
	temp1 = Math.floor(Math.random()*str.length);
	temp2 = str[temp1].length;
	temp3 = '';
	for(let i = 0;i<temp2;i++){
	if(i!=0){
			temp3+= username;
		}
		temp3 += str[temp1][i];
		
	}
	temp3+='<img src = "1.png" id ="bg-img"/>';
	temp3+='<img src = "logo.png" class ="logo"/>';
	c.innerHTML = temp3;

	
		let bgImg = document.getElementById('bg-img');

		document.getElementById('hide').style.display = "none";
		c.style.height = (document.body.clientWidth/bgImg.width)*bgImg.height+"px";
		c.style.width = document.body.clientWidth+'px';

		document.getElementsByTagName('body')[0].style.background='#f0f0f0';
		mask.style.visibility = "visible";
	c.style.display = "block";
	setTimeout("draw()","1500");
	//mask.style.visibility = "hidden";
	//mask2.style.visibility = "hidden";

}
function draw(){
	html2canvas(document.getElementById('test')).then(function(canvas) {
	c.style.display = 'none';
	let image = new Image();
	image.src = canvas.toDataURL("image/png");
	document.getElementById('t1').appendChild(image);
	let bt = document.createElement('button');
	bt.id = "btyellow";
	bt.innerHTML = "换  一  签";
	bt.onclick= function(){};
	bt.type="button";
	document.getElementById('t1').appendChild(bt);
	document.getElementById('t1').style.display = "inline-block";
		mask.style.visibility = "hidden";
	mask2.style.visibility = "hidden";
});
}
let c = document.getElementById('test');
let username;
let mask = document.getElementById('mask');
let mask2 = document.getElementById('mask2');
let temp1;
let temp2;
let temp3;
const str = [[
'<p>&emsp;&emsp;<span>','</span>在1906年考入复旦公学，1909年成为复旦公学第二届毕业生，其卒业文凭现在是复旦大学校史馆的“镇馆之宝”。</p>']

];
let x,y;
let divHide = document.getElementById('mask3');
let hid = document.getElementById('hide');
divHide.ontouchstart = function(e){let touch = e.touches[0];
	y=touch.clientY;
}
divHide.ontouchend = function(e){let touch = e.changedTouches[0];
	if(y - touch.clientY>70){
			hid.style.display = "block";
		  $("#mask3").animate({top:"-100%"});}
}
	</script>
	</body>
</html>